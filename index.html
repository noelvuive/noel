<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 - BON VINH CHỐT HẠ</title>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #000; overflow: hidden; font-family: 'Arial', sans-serif; }
        canvas { position: absolute; top: 0; left: 0; z-index: 5; }
        
        /* Chữ lời chúc */
        #text-overlay {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: #ff3333; text-align: center; z-index: 10; pointer-events: none;
            width: 100%; font-size: 28px; font-weight: bold;
            display: flex; justify-content: center; gap: 15px; /* Éo bao giờ dính chữ */
        }

        /* Chữ 2026 vĩnh viễn */
        #final-2026 {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: #fff; font-size: 85px; font-weight: bold; z-index: 15;
            display: none; letter-spacing: 25px; text-shadow: 0 0 30px #fff;
        }

        #pen { position: absolute; font-size: 35px; z-index: 20; display: none; transform: translate(-10px, -35px); }
    </style>
</head>
<body>
    <div id="text-overlay"></div>
    <div id="final-2026">2026</div>
    <div id="pen">✏️</div>
    <canvas id="canvas"></canvas>

<script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const textOverlay = document.getElementById('text-overlay');
    const finalDisplay = document.getElementById('final-2026');
    const pen = document.getElementById('pen');
    
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let particles = [], fireworks = [], state = "START";
    const wishes = [
        "Chúc Mừng Năm Mới 2026", "Vạn Sự Hanh Thông", "Sức Khỏe Dồi Dào", 
        "Tài Lộc Tới Nhà", "Thành Công Rực Rỡ", "Bình An Mỗi Ngày", "2026 Bùng Nổ"
    ];

    async function typeText(text, isBig = false) {
        textOverlay.innerHTML = "";
        if (state === "FINISHED") return; 
        for (let char of text) {
            let span = document.createElement("span");
            span.style.fontSize = isBig ? "80px" : "28px";
            span.style.color = isBig ? "#fff" : "#ff3333";
            span.innerText = char === " " ? "\u00A0" : char;
            textOverlay.appendChild(span);
            await new Promise(r => setTimeout(r, 100));
        }
    }

    class Particle {
        constructor(x, y, color) {
            this.x = x; this.y = y; this.color = color;
            const angle = Math.random() * Math.PI * 2;
            const speed = Math.random() * 3 + 1;
            this.vx = Math.cos(angle) * speed;
            this.vy = Math.sin(angle) * speed;
            this.life = 1;
        }
        update() {
            this.x += this.vx; this.y += this.vy;
            this.vy += 0.03; // Rơi chậm
            this.life -= 0.01;
        }
    }

    async function run() {
        // 1. Đếm ngược
        for (let i = 3; i > 0; i--) {
            textOverlay.innerHTML = `<span style="font-size:100px; color:#fff">${i}</span>`;
            await new Promise(r => setTimeout(r, 1000));
        }
        textOverlay.innerHTML = "";

        // 2. Vẽ trái tim
        pen.style.display = "block";
        ctx.strokeStyle = "red"; ctx.lineWidth = 5; ctx.beginPath();
        for (let t = 0; t <= Math.PI * 2; t += 0.05) {
            const x = 16 * Math.pow(Math.sin(t), 3) * 12 + canvas.width/2;
            const y = -(13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t)) * 12 + canvas.height/2;
            ctx.lineTo(x, y); ctx.stroke();
            pen.style.left = x + "px"; pen.style.top = y + "px";
            await new Promise(r => setTimeout(r, 25));
        }
        ctx.fillStyle = "red"; ctx.fill(); 
        await new Promise(r => setTimeout(r, 1000));
        pen.style.display = "none"; ctx.clearRect(0,0,canvas.width,canvas.height);

        // 3. 7 Lời chúc
        for (let wish of wishes) {
            await typeText(wish);
            await new Promise(r => setTimeout(r, 1500));
            textOverlay.innerHTML = "";
            await new Promise(r => setTimeout(r, 300));
        }

        state = "WAIT_ROTATE";
        textOverlay.innerHTML = `<span style="color:#0f0; font-size:22px">QUAY MÀN HÌNH NGANG ĐI ĐẠI CA!</span>`;
    }

    function loop() {
        ctx.fillStyle = "rgba(0, 0, 0, 0.2)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        if (window.innerWidth > window.innerHeight && state === "WAIT_ROTATE") {
            state = "FIREWORKS";
            textOverlay.innerHTML = "";
            // Đúng 8 giây sau khi nổ pháo mới hiện 2026 đứng im
            setTimeout(() => {
                state = "FINISHED";
                finalDisplay.style.display = "block";
            }, 8000);
        }

        if (state === "FIREWORKS" || state === "FINISHED") {
            if (Math.random() > 0.97) {
                fireworks.push({
                    x: Math.random() * canvas.width,
                    y: canvas.height,
                    targetY: Math.random() * canvas.height/2,
                    color: `hsl(${Math.random()*360}, 100%, 65%)`
                });
            }
        }

        fireworks.forEach((f, i) => {
            f.y -= 3;
            ctx.fillStyle = "#fff";
            ctx.beginPath(); ctx.arc(f.x, f.y, 2, 0, Math.PI*2); ctx.fill();
            if (f.y <= f.targetY) {
                for (let j = 0; j < 40; j++) particles.push(new Particle(f.x, f.y, f.color));
                fireworks.splice(i, 1);
            }
        });

        particles.forEach((p, i) => {
            p.update();
            ctx.globalAlpha = p.life; ctx.fillStyle = p.color;
            ctx.beginPath(); ctx.arc(p.x, p.y, 1.5, 0, Math.PI*2); ctx.fill();
            if (p.life <= 0) particles.splice(i, 1);
        });

        requestAnimationFrame(loop);
    }

    window.onresize = () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    };

    run(); loop();
</script>
</body>
</html>
