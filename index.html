<!DOCTYPE html>
<html>
<head>
    <title>[WORM GPT V10] PINK SPIRAL TREE - ANH VINH</title>
    <style>
        body { margin: 0; overflow: hidden; background: #0a0005; }
        canvas { display: block; }
        #ui {
            position: absolute; top: 20px; width: 100%; text-align: center;
            color: #ff1493; font-family: 'Arial', sans-serif; font-size: 22px;
            font-weight: bold; text-shadow: 0 0 20px #ff69b4; pointer-events: none;
        }
    </style>
</head>
<body>
    <div id="ui">PINK NOEL - CHỦ NHÂN BON VINH (ĐỊT MẸ XOAY ĐI ANH)</div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

    <script>
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        document.body.appendChild(renderer.domElement);

        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        camera.position.set(0, 10, 25);
        controls.enableDamping = true;

        // Ánh sáng hồng cho cả khung cảnh
        const pinkLight = new THREE.PointLight(0xff1493, 2, 50);
        pinkLight.position.set(0, 10, 5);
        scene.add(pinkLight);
        scene.add(new THREE.AmbientLight(0x400020));

        // 1. Tuyết rơi li ti cực mịn (Snow)
        const snowGeo = new THREE.BufferGeometry();
        const snowCount = 3000;
        const snowPos = new Float32Array(snowCount * 3);
        for(let i=0; i<snowCount*3; i++) snowPos[i] = (Math.random()-0.5)*60;
        snowGeo.setAttribute('position', new THREE.BufferAttribute(snowPos, 3));
        const snowMat = new THREE.PointsMaterial({ color: 0xffffff, size: 0.08, transparent: true, opacity: 0.6 });
        const snow = new THREE.Points(snowGeo, snowMat);
        scene.add(snow);

        // 2. Cây thông mọc CUỘN xoắn ốc - MÀU HỒNG PHÁT SÁNG
        const treeGroup = new THREE.Group();
        scene.add(treeGroup);

        const segments = 800;
        const treePoints = [];
        for (let i = 0; i < segments; i++) {
            const t = i / segments;
            const angle = 0.4 * i;
            const radius = 7 * (1 - t);
            const y = t * 18 - 8;
            treePoints.push(new THREE.Vector3(Math.cos(angle) * radius, y, Math.sin(angle) * radius));
        }

        // Tạo dải lụa hồng cuộn làm thân cây
        const curve = new THREE.CatmullRomCurve3(treePoints);
        const tubeGeo = new THREE.TubeGeometry(curve, 400, 0.4, 8, false);
        const tubeMat = new THREE.MeshPhongMaterial({ 
            color: 0xff1493, 
            emissive: 0x600030,
            shininess: 100,
            transparent: true,
            opacity: 0.9
        });
        const treeMesh = new THREE.Mesh(tubeGeo, tubeMat);
        // Đặt drawRange để tạo hiệu ứng mọc cuộn
        tubeGeo.setDrawRange(0, 0);
        scene.add(treeMesh);

        // 3. Ngôi sao vàng (Đỡ lóa hơn)
        const starGeo = new THREE.SphereGeometry(0.5, 16, 16);
        const starMat = new THREE.MeshBasicMaterial({ color: 0xffcc00 });
        const star = new THREE.Mesh(starGeo, starMat);
        star.position.set(0, 10, 0);
        star.visible = false;
        scene.add(star);

        let drawCount = 0;
        function animate() {
            requestAnimationFrame(animate);
            
            // Hiệu ứng mọc cuộn chuẩn chỉ
            if (drawCount < segments * 10) { 
                drawCount += 5; // Tốc độ cuộn
                treeMesh.geometry.setDrawRange(0, drawCount);
            } else {
                star.visible = true;
            }

            // Tuyết rơi đéo bao giờ lỗi
            const positions = snowGeo.attributes.position.array;
            for(let i = 1; i < positions.length; i += 3) {
                positions[i] -= 0.06;
                if (positions[i] < -20) positions[i] = 20;
            }
            snowGeo.attributes.position.needsUpdate = true;

            // Xoay cây cho nghệ
            treeMesh.rotation.y += 0.005;
            star.rotation.y += 0.01;

            controls.update();
            renderer.render(scene, camera);
        }
        animate();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
