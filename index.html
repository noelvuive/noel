<!DOCTYPE html>
<html>
<head>
    <title>[WORM GPT] NOEL 3D CHO ANH VINH</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; }
        canvas { display: block; }
        #instruction {
            position: absolute; top: 10px; width: 100%; text-align: center;
            color: white; font-family: Arial; pointer-events: none; text-shadow: 2px 2px 4px #000;
        }
    </style>
</head>
<body>
    <div id="instruction">Địt mẹ anh Vinh! Dùng chuột xoay để xem cây thông 3D nhé!</div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

    <script>
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        camera.position.set(0, 5, 15);
        controls.update();

        // Ánh sáng
        const light = new THREE.PointLight(0xffffff, 1, 100);
        light.position.set(0, 10, 10);
        scene.add(light);
        scene.add(new THREE.AmbientLight(0x404040));

        // Tuyết rơi
        const snowCount = 1000;
        const snowGeo = new THREE.BufferGeometry();
        const snowPos = new Float32Array(snowCount * 3);
        for(let i=0; i<snowCount*3; i++) { snowPos[i] = (Math.random() - 0.5) * 30; }
        snowGeo.setAttribute('position', new THREE.BufferAttribute(snowPos, 3));
        const snowMat = new THREE.PointsMaterial({ color: 0xffffff, size: 0.1 });
        const snow = new THREE.Points(snowGeo, snowMat);
        scene.add(snow);

        // Logic mọc cây thông xoắn ốc
        const treeGroup = new THREE.Group();
        scene.add(treeGroup);

        let progress = 0;
        const maxPoints = 500;
        const lights = [];

        function createTreePart() {
            if (progress < maxPoints) {
                const t = progress / maxPoints;
                const angle = 0.2 * progress;
                const radius = 5 * (1 - t);
                const y = t * 10;
                
                const x = Math.cos(angle) * radius;
                const z = Math.sin(angle) * radius;

                // Lá cây (hạt xanh)
                const dotGeo = new THREE.SphereGeometry(0.1, 8, 8);
                const dotMat = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
                const dot = new THREE.Mesh(dotGeo, dotMat);
                dot.position.set(x, y, z);
                treeGroup.add(dot);

                // Thỉnh thoảng thêm đèn màu
                if (progress % 15 === 0) {
                    const colors = [0xff0000, 0xffff00, 0x0000ff, 0xff00ff];
                    const lightGeo = new THREE.SphereGeometry(0.15, 8, 8);
                    const lightMat = new THREE.MeshBasicMaterial({ color: colors[Math.floor(Math.random()*colors.length)] });
                    const lightBall = new THREE.Mesh(lightGeo, lightMat);
                    lightBall.position.set(x, y, z);
                    treeGroup.add(lightBall);
                }
                progress++;
            }
        }

        // Ngôi sao trên đỉnh
        let starCreated = false;
        function addStar() {
            const starGeo = new THREE.SphereGeometry(0.4, 12, 12);
            const starMat = new THREE.MeshBasicMaterial({ color: 0xffd700 });
            const star = new THREE.Mesh(starGeo, starMat);
            star.position.set(0, 10.5, 0);
            treeGroup.add(star);
        }

        function animate() {
            requestAnimationFrame(animate);
            
            // Tuyết rơi xuống
            snow.position.y -= 0.05;
            if (snow.position.y < -15) snow.position.y = 15;

            // Mọc cây
            if (progress < maxPoints) {
                createTreePart();
            } else if (!starCreated) {
                addStar();
                starCreated = true;
            }

            renderer.render(scene, camera);
        }

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        animate();
    </script>
</body>
</html>
