<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 - BON VINH SUPREME</title>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #000; overflow: hidden; font-family: 'Arial', sans-serif; touch-action: none; }
        canvas { position: absolute; top: 0; left: 0; }
        #text-overlay {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: #fff; text-align: center; z-index: 10; pointer-events: none; width: 100%;
        }
        .word { display: inline-block; margin: 0 10px; font-size: 50px; font-weight: bold; }
        .wish-text .word { font-size: 24px !important; color: #ff3333 !important; }
        #pen { position: absolute; font-size: 30px; z-index: 20; display: none; pointer-events: none; }
    </style>
</head>
<body>
    <div id="text-overlay"></div>
    <div id="pen">✏️</div>
    <canvas id="canvas"></canvas>

<script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const textOverlay = document.getElementById('text-overlay');
    const pen = document.getElementById('pen');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let particles = [];
    let state = "START";
    const wishes = [
        "Chúc Mừng Năm Mới 2026",
        "Vạn Sự Hanh Thông Tỷ Sự Như Mơ",
        "Sức Khỏe Dồi Dào Tài Lộc Tới",
        "Hạnh Phúc Đong Đầy Mọi Nẻo Đường",
        "Thành Công Vang Dội Tuổi Trẻ",
        "Bình An Mạnh Khỏe Mỗi Ngày",
        "Chào Đón 2026 Bùng Nổ Rạng Ngời"
    ];

    async function typeAndFade(text) {
        textOverlay.innerHTML = "";
        textOverlay.className = "wish-text";
        let words = text.split(" ");
        for (let word of words) {
            let span = document.createElement("span");
            span.className = "word";
            span.innerText = word;
            textOverlay.appendChild(span);
            await new Promise(r => setTimeout(r, 150));
        }
        await new Promise(r => setTimeout(r, 800)); // Chờ đọc xong
        // Tan biến nhanh
        textOverlay.style.transition = "0.3s opacity";
        textOverlay.style.opacity = "0";
        await new Promise(r => setTimeout(r, 300));
        textOverlay.innerHTML = "";
        textOverlay.style.opacity = "1";
    }

    class Particle {
        constructor(x, y, color, vx, vy, life = 1) {
            this.x = x; this.y = y; this.color = color;
            this.vx = vx; this.vy = vy;
            this.life = life;
            this.gravity = 0.05; // Rơi chậm
        }
        update() {
            this.x += this.vx; this.y += this.vy;
            this.vy += this.gravity;
            this.life -= 0.01;
        }
        draw() {
            ctx.globalAlpha = this.life;
            ctx.fillStyle = this.color;
            ctx.beginPath(); ctx.arc(this.x, this.y, 1.5, 0, Math.PI*2); ctx.fill();
        }
    }

    async function run() {
        // 1. 3-2-1
        for (let i = 3; i > 0; i--) { 
            textOverlay.innerHTML = `<div class="word" style="font-size:100px">${i}</div>`; 
            await new Promise(r => setTimeout(r, 1000)); 
        }
        textOverlay.innerHTML = `<div class="word">2026</div>`;
        await new Promise(r => setTimeout(r, 1000));
        textOverlay.innerHTML = "";

        // 2. Cây bút vẽ trái tim
        pen.style.display = "block";
        ctx.strokeStyle = "red"; ctx.lineWidth = 4; ctx.beginPath();
        for (let t = 0; t <= Math.PI * 2; t += 0.05) {
            const x = 16 * Math.pow(Math.sin(t), 3) * 10 + canvas.width/2;
            const y = -(13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t)) * 10 + canvas.height/2;
            ctx.lineTo(x, y); ctx.stroke();
            pen.style.left = x + "px"; pen.style.top = y + "px";
            await new Promise(r => setTimeout(r, 20));
        }
        ctx.fillStyle = "red"; ctx.fill();
        await new Promise(r => setTimeout(r, 1000));
        pen.style.display = "none";
        ctx.clearRect(0,0,canvas.width,canvas.height);

        // 3. 7 Lời chúc tan biến nhanh
        for (let wish of wishes) {
            await typeAndFade(wish);
        }

        // 4. Quay ngang màn hình
        textOverlay.innerHTML = `<div class="word" style="color:#0f0; font-size:25px">QUAY MÀN HÌNH NGANG ĐI ĐẠI CA!</div>`;
        state = "WAIT_ROTATE";
    }

    function createFirework(type) {
        const x = Math.random() * canvas.width;
        const targetY = canvas.height * 0.3;
        const color = "#fff"; // Một màu như đại ca yêu cầu

        if(type === 'heart') {
            for (let t = 0; t < Math.PI * 2; t += 0.2) {
                const vx = 16 * Math.pow(Math.sin(t), 3) * 0.2;
                const vy = -(13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t)) * 0.2;
                particles.push(new Particle(x, targetY, color, vx, vy));
            }
        } else {
            for(let i=0; i<50; i++) {
                particles.push(new Particle(x, targetY, color, (Math.random()-0.5)*5, (Math.random()-0.5)*5));
            }
        }
    }

    function loop() {
        ctx.fillStyle = "rgba(0, 0, 0, 0.2)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        if (window.innerWidth > window.innerHeight && state === "WAIT_ROTATE") {
            state = "SHOW_3D";
            textOverlay.innerHTML = "";
        }

        if (state === "SHOW_3D") {
            if(Math.random() > 0.97) {
                createFirework(Math.random() > 0.5 ? 'heart' : 'normal');
            }
        }

        particles.forEach((p, i) => {
            p.update(); p.draw();
            if(p.life <= 0) particles.splice(i, 1);
        });
        requestAnimationFrame(loop);
    }

    run(); loop();
</script>
</body>
</html>
